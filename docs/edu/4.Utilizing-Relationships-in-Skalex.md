Section 4: Utilizing Relationships in Skalex

In Skalex, you can establish relationships between collections to create linked data structures. This section will guide you through the process of setting up relationships and querying related data efficiently. Let's explore how to leverage relationships in Skalex.

4.1 Establishing Relationships between Collections

To establish a relationship between two collections, you can use the `link` method provided by Skalex. Let's consider an example where we have two collections: `users` and `posts`. Each user can have multiple posts associated with them. Here's how you can define this relationship:

```javascript
const skalex = require("skalex");

const db = new skalex.Database();

// Creating the 'users' collection
const users = db.collection("users");

// Creating the 'posts' collection
const posts = db.collection("posts");

// Establishing a relationship between 'users' and 'posts'
users.link(posts, "userId", "posts", "authorId");
```

In the above code, we establish a relationship between the `users` collection and the `posts` collection using the `link` method. We specify the field name `userId` in the `users` collection that corresponds to the field name `authorId` in the `posts` collection. This establishes the connection between the two collections.

4.2 Querying Related Data

Once the relationship is established, you can easily query related data using Skalex's query capabilities. Let's say we want to retrieve all posts written by a specific user with the ID `123`. Here's how you can accomplish this:

```javascript
const user = users.findOne({ id: 123 });
const userPosts = user.posts; // Access the 'posts' property to retrieve the related posts
```

In the above code, we use the `findOne` method to find the user with the ID `123` in the `users` collection. We can then access the `posts` property of the `user` object to retrieve the related posts.

4.3 Efficient Querying of Related Data

Skalex provides efficient querying options for related data. Let's say we want to find all users who have at least one post. We can use the `populate` method to retrieve the related posts and filter the users accordingly:

```javascript
const usersWithPosts = users
  .populate("posts")
  .find({ "posts.length": { $gt: 0 } });
```

In the above code, we use the `populate` method to fetch the related posts for each user in the `users` collection. We then use the `find` method with a query condition to filter the users based on the number of posts they have.

By utilizing relationships in Skalex, you can create powerful data structures and efficiently query related data across collections. Experiment with different relationship setups and leverage Skalex's querying capabilities to meet the specific requirements of your projects.
